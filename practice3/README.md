
# Практическая работа №3 Kurmash Zhumagozhayev ADA-2401M  


---

## 1. Цель работы

Целью данной практической работы является освоение принципов гетерогенной
параллелизации и программирования на CUDA, а также реализация и анализ
производительности алгоритмов сортировки при выполнении на CPU и GPU.

В рамках работы:
- реализованы последовательные алгоритмы сортировки на CPU;
- реализована параллельная сортировка на GPU с использованием CUDA;
- выполнено сравнение производительности CPU и GPU реализаций.

---

## 2. Реализованные алгоритмы

### CPU (последовательные реализации)
- Сортировка слиянием (Merge Sort)
- Быстрая сортировка (Quick Sort)
- Пирамидальная сортировка (Heap Sort)

### GPU (CUDA)
- Параллельная сортировка слиянием (блочная версия на основе bitonic sort)

GPU-реализация используется для демонстрации принципов гетерогенных вычислений
и параллельной обработки данных.

---

## 3. Архитектура проекта

Проект логически разделен на CPU и GPU части, что отражает гетерогенную модель
вычислений.


- `cpu_sorts.cpp` — реализации алгоритмов сортировки на CPU  
- `gpu_sorts.cu` — CUDA-реализация параллельной сортировки  
- `main.cpp` — генерация данных, запуск алгоритмов и замер времени  

---

## 4. Среда выполнения

- IDE: CLion (Remote Development)
- Язык программирования: C++17
- Параллельные вычисления: CUDA
- Запуск GPU-кода: удаленный сервер с CUDA-совместимым GPU

---

## 5. Измерение производительности

- Время выполнения алгоритмов на CPU измерялось с использованием  
  `std::chrono::high_resolution_clock`.
- Время выполнения GPU-алгоритма измерялось с использованием  
  CUDA Events (`cudaEventRecord`, `cudaEventElapsedTime`).

---

## 6. Результаты экспериментов

### Время выполнения алгоритмов (мс)

| Размер массива | CPU Merge Sort | CPU Quick Sort | CPU Heap Sort | GPU Merge Sort |
|---------------|---------------|---------------|---------------|---------------|
| 10 000        | 5             | 1             | 2             | 0.026         |
| 100 000       | 81            | 19            | 35            | 0.038         |
| 1 000 000     | 738           | 265           | 468           | 0.234         |

---

## 7. Анализ результатов

- Быстрая сортировка (Quick Sort) показала наилучшее время выполнения на CPU.
- Сортировка слиянием и пирамидальная сортировка имеют более стабильную,
  но менее быструю производительность на CPU.
- GPU-реализация демонстрирует значительное ускорение за счет
  параллельной обработки данных.
- GPU-сортировка выполняет локальную параллельную сортировку внутри блоков,
  что соответствует одной из стадий алгоритма Merge Sort.

---

## 8. Особенности GPU-реализации

GPU-реализация сортировки слиянием выполнена в виде блочной параллельной
сортировки (bitonic sort), которая соответствует стадии локальной сортировки
в алгоритме Merge Sort.

Глобальный этап слияния между блоками в рамках данной практической работы
не реализован, так как его реализация существенно усложняет код и выходит
за рамки лабораторной работы.

---

## 9. Выводы

В ходе выполнения практической работы:
- были изучены основы гетерогенной параллелизации;
- реализованы и протестированы алгоритмы сортировки на CPU и GPU;
- экспериментально подтверждена эффективность параллельных вычислений на GPU
  при обработке больших объемов данных.

Полученные результаты демонстрируют преимущества использования GPU
в задачах, допускающих высокий уровень параллелизма.

---

## 10. Контрольные вопросы

1. В чем различие между последовательной и параллельной реализациями сортировки слиянием?

Последовательная реализация сортировки слиянием выполняется в одном потоке выполнения на CPU. Массив рекурсивно делится на части, каждая часть сортируется последовательно, после чего выполняется операция слияния. Все этапы выполняются строго друг за другом.

Параллельная реализация сортировки слиянием предполагает одновременную обработку нескольких частей массива. На GPU или в многопоточной среде разные блоки данных сортируются параллельно разными потоками, после чего выполняется этап слияния результатов. Это позволяет значительно сократить общее время выполнения за счет одновременной обработки данных.

2. Как распределение потоков и блоков влияет на производительность на CUDA?

Распределение потоков и блоков напрямую влияет на степень загрузки вычислительных ресурсов GPU. Если количество потоков слишком мало, GPU используется неэффективно и часть вычислительных блоков простаивает. Если потоков слишком много или размер блоков выбран неудачно, возникают накладные расходы на управление потоками и синхронизацию.

Оптимальное распределение потоков и блоков позволяет:

максимально загрузить все вычислительные ядра GPU;

минимизировать простои;

повысить пропускную способность памяти.

3. Какие сложности возникают при реализации быстрой сортировки на GPU?

Основные сложности реализации быстрой сортировки на GPU связаны с ее рекурсивной и нерегулярной природой. Алгоритм quick sort предполагает:

выбор опорного элемента;

неравномерное разбиение массива;

рекурсивные вызовы разной глубины.

На GPU это приводит к дивергенции потоков, когда разные потоки выполняют разные ветви кода, а также к сложностям с синхронизацией и управлением памятью. Из-за этого быстрая сортировка плохо масштабируется на GPU по сравнению с алгоритмами с более регулярной структурой.

4. В каких случаях параллельная реализация сортировки на GPU может быть менее эффективной, чем на CPU?

Параллельная реализация сортировки на GPU может быть менее эффективной в следующих случаях:

при небольшом размере входных данных;

при больших накладных расходах на копирование данных между CPU и GPU;

при наличии сложной логики синхронизации между потоками;

при неудачном выборе параметров сетки и блоков.

В таких ситуациях время на организацию параллельных вычислений может превышать выигрыш от параллелизма.

5. Почему важно правильно выбирать размер блоков и потоков в CUDA?

Размер блоков и количество потоков определяют, насколько эффективно используется архитектура GPU. Неправильный выбор может привести к:

низкой загрузке вычислительных блоков;

увеличению времени доступа к памяти;

избыточной синхронизации потоков.

Правильный выбор параметров позволяет добиться максимальной параллельности, оптимального использования памяти и высокой производительности вычислений.

6. Как использование разделяемой памяти может повлиять на производительность сортировки?

Разделяемая память значительно быстрее глобальной памяти GPU и используется для обмена данными между потоками одного блока. При сортировке использование разделяемой памяти позволяет:

уменьшить количество обращений к глобальной памяти;

сократить задержки доступа к данным;

ускорить операции сравнения и обмена элементов.

Однако объем разделяемой памяти ограничен, поэтому ее использование требует аккуратного проектирования алгоритма.

7. Что означает принцип "разделяй и властвуй" в контексте алгоритмов сортировки?

Принцип «разделяй и властвуй» означает разбиение исходной задачи на несколько меньших подзадач, которые решаются независимо, а затем их результаты объединяются. В алгоритмах сортировки это обычно выглядит как:

разделение массива на части;

сортировка каждой части;

объединение отсортированных частей в итоговый результат.

Такой подход упрощает реализацию алгоритмов и хорошо масштабируется в параллельной среде.
